<div class="index-container" style="max-width: 600px; margin: 0 auto; padding: 20px; font-family: sans-serif; background-color: #D3D3D3; min-height: 100vh;">
  
  <%# --- 1. イベント名 --- %>
  <div style="text-align: center; margin-bottom: 25px;">
    <h1 style="color: #333; margin: 0; font-size: 28px; font-weight: 900;"><%= @competition.name %></h1>
    <p style="color: #666; font-size: 13px; margin-top: 5px;">このページのURLをシェアしよう！</p>
  </div>

  <%# --- 2. 正解表示エリア --- %>
  <% if @competition.answer_colors.present? %>
    <div style="background: #FFD700; border: 3px solid #000; border-radius: 15px; padding: 15px; margin-bottom: 30px; box-shadow: 6px 6px 0 #b8860b;">
      <h2 style="text-align: center; font-size: 18px; margin-bottom: 12px; color: #000;">🏆 正解（リザルト） 🏆</h2>
      <div style="display: flex; gap: 8px; justify-content: center;">
        <% @competition.answer_colors.each_with_index do |color, i| %>
          <div style="text-align: center; width: 45px;">
            <div style="width: 100%; aspect-ratio: 1/1; border-radius: 50%; background-color: <%= color %>; border: 2px solid #000;"></div>
            <span style="font-size: 11px; font-weight: bold;"><%= i + 1 %></span>
          </div>
        <% end %>
      </div>
    </div>
  <% else %>
    <div style="background: #fff; border: 2px dashed #999; border-radius: 15px; padding: 15px; margin-bottom: 30px; text-align: center; color: #888;">
      <p style="margin: 0; font-weight: bold;">🏁 結果待ち</p>
      <p style="margin: 5px 0 0; font-size: 12px;">主催者が正解を入力すると的中判定されます</p>
    </div>
  <% end %>

  <%# --- 3. 予想カード一覧 --- %>
  <div class="prediction-history">
    <% if @predictions.any? %>
      <% @predictions.reverse_each do |prediction| %>
        <% 
          correct_count = 0
          if @competition.answer_colors.present?
            prediction.ranking_items.order(:rank).each_with_index do |item, index|
              correct_count += 1 if item.color_code == @competition.answer_colors[index]
            end
          end
        %>

        <div class="prediction-card" style="position: relative; background: white; border-radius: 12px; padding: 20px; margin-bottom: 20px; border: 3px solid #000; box-shadow: 4px 4px 0 rgba(0,0,0,0.1);">
          <% if @competition.answer_colors.present? %>
            <div style="position: absolute; top: -12px; right: -12px; background: #ff4500; color: white; border-radius: 50%; width: 55px; height: 55px; display: flex; flex-direction: column; align-items: center; justify-content: center; border: 3px solid #fff; box-shadow: 0 4px 8px rgba(0,0,0,0.2); z-index: 10; transform: rotate(10deg);">
              <span style="font-size: 16px; font-weight: 900;"><%= correct_count %></span>
              <span style="font-size: 9px; font-weight: bold;">的中!</span>
            </div>
          <% end %>

          <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; border-bottom: 2px solid #f0f0f0; padding-bottom: 8px;">
            <span style="font-size: 18px; font-weight: bold; color: #333;"><%= prediction.name.presence || "名無しの予想屋" %></span>
            <%= button_to "削除", prediction_path(prediction), method: :delete, data: { turbo_confirm: "削除しますか？" }, style: "background: #eee; color: #999; border: none; border-radius: 4px; padding: 4px 8px; font-size: 10px; cursor: pointer;" %>
          </div>
          
          <div style="display: flex; gap: 8px; justify-content: flex-start;">
            <% prediction.ranking_items.order(:rank).each_with_index do |item, index| %>
              <% is_correct = @competition.answer_colors.present? && item.color_code == @competition.answer_colors[index] %>
              <div style="text-align: center; width: calc(100% / 6 - 8px); min-width: 45px;">
                <div style="width: 100%; aspect-ratio: 1/1; border-radius: 50%; background-color: <%= item.color_code %>; border: <%= is_correct ? '4px solid #ff4500' : '2px solid #ccc' %>; box-sizing: border-box;"></div>
                <span style="font-size: 11px; font-weight: bold; color: <%= is_correct ? '#ff4500' : '#888' %>;"><%= item.rank %></span>
              </div>
            <% end %>
          </div>
        </div>
      <% end %>
    <% end %>
  </div>

  <%# --- 4. 復活させたフッターボタンエリア --- %>
  <div style="text-align: center; margin-top: 40px; padding-bottom: 80px; display: flex; flex-direction: column; gap: 15px; align-items: center;">
    
    <%# 予想するボタン（一番目立たせる） %>
    <%= link_to "🎯 新しく予想する", new_prediction_path(competition_id: @competition.id), style: "background-color: #fff; color: #000; text-decoration: none; padding: 18px 30px; border: 3px solid #000; font-weight: bold; font-size: 18px; border-radius: 50px; box-shadow: 0 6px 0 #000; width: 80%; display: block;" %>
    
    <div style="display: flex; gap: 10px; width: 80%; justify-content: center;">
      <%# 正解入力ボタン %>
      <%= link_to "🏆 正解入力", edit_competition_path(@competition), style: "background-color: #FFD700; color: #000; text-decoration: none; padding: 12px 20px; border: 2px solid #000; font-weight: bold; font-size: 14px; border-radius: 10px; flex: 1; display: block;" %>
      
      <%# トップに戻るボタン %>
      <%= link_to "🏠 トップ", root_path, style: "background-color: #eee; color: #333; text-decoration: none; padding: 12px 20px; border: 2px solid #333; font-weight: bold; font-size: 14px; border-radius: 10px; flex: 1; display: block;" %>
    </div>

  </div>
</div>